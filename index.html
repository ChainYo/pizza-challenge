
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Classifying pizza requests">
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.8">
    
    
      
        <title>Pizza Challenge</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.644de097.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL(".",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="red">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#planning" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Pizza Challenge" class="md-header__button md-logo" aria-label="Pizza Challenge" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Pizza Challenge
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              üçï Pizza Challenge
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="red"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="orange" data-md-color-accent="red"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ChainYo/pizza-challenge" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    ChainYo/pizza-challenge
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Pizza Challenge" class="md-nav__button md-logo" aria-label="Pizza Challenge" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Pizza Challenge
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ChainYo/pizza-challenge" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    ChainYo/pizza-challenge
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          üçï Pizza Challenge
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        üçï Pizza Challenge
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#planning" class="md-nav__link">
    üìÖ Planning
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cleaning-and-exploring-the-data" class="md-nav__link">
    üßπ Cleaning and Exploring the Data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#more-data-exploration" class="md-nav__link">
    üîé More Data Exploration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preprocessing" class="md-nav__link">
    ‚öôÔ∏è Preprocessing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#first-model" class="md-nav__link">
    üß≠ First Model
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deep-learning-model" class="md-nav__link">
    üß† Deep Learning Model
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#onnx-optimization" class="md-nav__link">
    üíÖ ONNX Optimization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#serving-api" class="md-nav__link">
    üßÉ Serving API
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interface" class="md-nav__link">
    üñ•Ô∏è Interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#to-be-continued" class="md-nav__link">
    üñãÔ∏è To be continued...
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#planning" class="md-nav__link">
    üìÖ Planning
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cleaning-and-exploring-the-data" class="md-nav__link">
    üßπ Cleaning and Exploring the Data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#more-data-exploration" class="md-nav__link">
    üîé More Data Exploration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preprocessing" class="md-nav__link">
    ‚öôÔ∏è Preprocessing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#first-model" class="md-nav__link">
    üß≠ First Model
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deep-learning-model" class="md-nav__link">
    üß† Deep Learning Model
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#onnx-optimization" class="md-nav__link">
    üíÖ ONNX Optimization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#serving-api" class="md-nav__link">
    üßÉ Serving API
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interface" class="md-nav__link">
    üñ•Ô∏è Interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#to-be-continued" class="md-nav__link">
    üñãÔ∏è To be continued...
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/ChainYo/pizza-challenge/edit/master/docs/index.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>



  <h1>üçï Pizza Challenge</h1>

<p>This is the documentation for the challenge, how it works and what I did during this week.</p>
<p><center>
<img src="img/pizza-i-love-pizza.gif"></p>
<p><em>Me working on the challenge...</em>
</center></p>
<h2 id="planning">üìÖ Planning</h2>
<p>I started by thinking about the problem in a way that I could understand it.</p>
<p><strong>What is the challenge goal?</strong> </p>
<p><strong>What is the problem?</strong></p>
<p><strong>What type of data do we have?</strong> </p>
<p><strong>What do I need to build as a solution?</strong></p>
<p>This is the plan I have set out for the challenge:</p>
<p><img alt="challenge plan" src="img/planning.jpeg" /></p>
<p>I followed most of the plan and its order, but machine learning problems are more an iterative process than a linear one.</p>
<p>Since the beginning of the challenge I wanted to try a classic machine learning model to solve the problem, and then
try a deep learning model to see which one is better and if it's worth it to use for the challenge.</p>
<h2 id="cleaning-and-exploring-the-data">üßπ Cleaning and Exploring the Data</h2>
<ul>
<li><a href="https://github.com/ChainYo/pizza-challenge/blob/master/notebooks/cleaning.ipynb">Notebook</a></li>
</ul>
<p>I started the exploration with a bit of data cleaning.</p>
<p>There was some missing data in the dataset and some unnecessary data.</p>
<h2 id="more-data-exploration">üîé More Data Exploration</h2>
<ul>
<li><a href="https://github.com/ChainYo/pizza-challenge/blob/master/notebooks/exploration.ipynb">Notebook</a></li>
</ul>
<p>Then, I started really exploring the data.</p>
<p>I focused on text data which is the most relevant for this challenge in my opinion.</p>
<p>So, I cleaned with <code>regex</code> request text data and did some wordclouds.</p>
<p>Here is the wordcloud of the most common words in the <code>requester_text</code> column:</p>
<p><img alt="wordcloud" src="img/wordcloud.png" /></p>
<p>I also found that negative requests contain a lot of misspellings.</p>
<h2 id="preprocessing">‚öôÔ∏è Preprocessing</h2>
<ul>
<li><a href="https://github.com/ChainYo/pizza-challenge/blob/master/notebooks/preprocessing.ipynb">Notebook</a></li>
</ul>
<p>Then I started to preprocess the data before building any model.</p>
<p>I have replaced <code>True</code> and <code>False</code> with <code>1</code> and <code>0</code> in the <code>requester_received_pizza</code> column which will be the target column.</p>
<p>I also arranged some columns in a way that I could use them for a training if needed.</p>
<h2 id="first-model">üß≠ First Model</h2>
<ul>
<li><a href="https://github.com/ChainYo/pizza-challenge/blob/master/notebooks/random_forest_classifier.ipynb">Notebook</a></li>
</ul>
<p>I started with the idea to build a simple <code>RandomForestClassifier</code> model with only the text data.</p>
<p>I used an old notebook I had written months ago where I used <code>nltk</code> and <code>gensim.word2vec</code> to build a word2vec model.</p>
<p>So I used <code>nltk</code> to tokenize the text data in order to build the vocabulary of the model. This model can be used 
to create clusters of words that are similar to each other. </p>
<p>226 clusters were created and used to create a mapping between the words and their clusters. </p>
<p>This mapping is used to create multiple bags of centroids, which are used to create the features for the model.</p>
<p>With the dataset created, I started to train the model. I used <code>Optuna</code> to optimize the hyperparameters of the model and
to help me find the best model.</p>
<p><img alt="best classifier" src="img/classifier-conf-matrix.png" /></p>
<p>As you can see, the model is not <em>very good</em>. üòÖ</p>
<p>Because, I was not really confident in the model choice and the tools I used, I decided to give up on this approach and
try a deep learning model, which passion me more.</p>
<h2 id="deep-learning-model">üß† Deep Learning Model</h2>
<ul>
<li><a href="https://github.com/ChainYo/pizza-challenge/blob/master/notebooks/deep_learning.ipynb">Notebook</a> | <a href="https://github.com/ChainYo/pizza-challenge/blob/master/src/pizza_challenge/pipelines/training/model.py">Implementation</a></li>
</ul>
<p>I switched to a deep learning model and started to think about the problem and which model to use.</p>
<p>I decided to <strong>fine tune a transformers model</strong> on a downstream task, which is a <strong>classification task</strong> in this case.</p>
<p>As a backbone of the model, I used a <code>bert-base-uncased</code> model which is a pretrained model from the <strong>Hugging Face</strong> library.</p>
<p>The model has been trained to be able to read and understand english text, so it will be fine for our task.</p>
<p>In order to fine tune the model, I have added a simple classification layer to the model.</p>
<p>I used <code>PyTorch-Lightning</code> for the implementation of the model, because it's the <strong>best library for implementing deep
learning models and deploying them on a production environment</strong>.</p>
<p>All training logs are saved via <code>Weights and Biases</code> and could be accessed via the <a href="https://wandb.ai/chainyo-mleng/challenge">Project Pizza Challenge</a> on <a href="https://wandb.ai/">Weights and Biases</a>.</p>
<p>Let's take a look at the training pipeline:</p>
<p><img alt="training pipeline" src="img/training-pipeline.png" /></p>
<p>I used <code>Kedro</code> to package the pipeline and it allows me to <strong>run the pipeline on a local machine or on a cloud service</strong>.</p>
<p>With only the command <code>kedro run</code> I could run the pipeline and train another model and export it to ONNX. The new
model will be placed in the api folder and can be used to predict the pizza requests.</p>
<h2 id="onnx-optimization">üíÖ ONNX Optimization</h2>
<ul>
<li><a href="https://github.com/ChainYo/pizza-challenge/blob/master/src/pizza_challenge/pipelines/training/nodes.py#L114">Implementation</a></li>
</ul>
<p>ONNX is a format for storing and running deep learning models on any hardware and with any coding language.</p>
<p>You can run models on the CPU, GPU, or even edge TPUs. It's possible to launch <code>InferenceSession</code> on Python, C++, or
Java (and many more).</p>
<p>It's really a great way to package your model and run it on production environments. Plus, it allows <strong>faster inference
times on CPUs</strong>.</p>
<h2 id="serving-api">üßÉ Serving API</h2>
<ul>
<li><a href="https://github.com/ChainYo/pizza-challenge/tree/master/api">Implementation</a></li>
</ul>
<p>This is the API that I have created to serve the model. It's a simple <code>FastAPI</code> server that has a <code>POST</code> endpoint
that accepts a JSON payload with a <code>sample</code> field and returns a <code>JSON</code> response with a <code>prediction</code> field.</p>
<p><img alt="api" src="img/api-endpoints.png" /></p>
<p>The API is dockerized and could be <strong>deployed on any cloud service</strong>. I have added 2 monitoring endpoints <code>healthz</code> and
<code>readyz</code> to check if the server is running and ready to serve requests. These endpoints are used by <strong>Kubernetes</strong> for 
automated deployments.</p>
<h2 id="interface">üñ•Ô∏è Interface</h2>
<ul>
<li><a href="https://github.com/ChainYo/pizza-challenge/tree/master/interface">Implementation</a></li>
</ul>
<p>I have build a simple interface to interact with the API. There is a text input field and a button that when clicked
will send the text to the API and display the prediction.</p>
<p><img alt="interface" src="img/pizza-requester-app.png" /></p>
<p>The interface is built with <code>Streamlit</code>, is dockerized and could be deployed on any cloud service.</p>
<hr />
<p>This command at the root directory of the project should launch the API and the Interface:</p>
<div class="highlight"><pre><span></span><code>docker-compose up -d
</code></pre></div>
<p>API: <a href="http://127.0.0.1:80"><code>http://127.0.0.1:80</code></a></p>
<p>Dashboard: <a href="http://127.0.0.1:8501"><code>http://127.0.0.1:8501</code></a></p>
<hr />
<h2 id="to-be-continued">üñãÔ∏è To be continued...</h2>
<ul>
<li>Add another model like <code>XGBoost</code> or <code>LightGBM</code> to use others metadata features from the dataset.</li>
<li>Augment the dataset with more data.</li>
<li>Try <code>DistilBERT</code> or <code>Roberta</code> as a model backbone.</li>
<li>Add more metrics to evaluate the model.</li>
<li>Improve model serving with logging.</li>
<li>Deploy model on cloud (+ load balancer).</li>
<li>Add input verification layer to avoid data drift (something like <a href="https://greatexpectations.io/">great_expectations</a>).</li>
<li>Add ETL tool to automate re-training of the model via API calls or scheduled training jobs.</li>
<li>Add a dashboard to visualize the model performance.</li>
<li>Improve dockerization by installing only required dependencies for API.</li>
<li>Add data versioning with tools like <a href="https://dvc.org/">DVC</a>.</li>
<li>Add model versioning with tools like <a href="https://www.mlflow.org/">MLflow</a>.</li>
<li>Use cleaning methods, used before training, on text sent by the interface.</li>
</ul>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      2022-03-28
    
  </small>
</div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.tracking"], "search": "assets/javascripts/workers/search.5e67fbfe.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.c44cc438.min.js"></script>
      
    
  </body>
</html>